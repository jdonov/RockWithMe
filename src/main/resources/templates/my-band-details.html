<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div th:object="${myBand}">
    <p th:text="*{name}"></p>
    <div>
        <img th:src="*{imgUrl}">
    </div>
    <th:block th:each="m : *{members}">
        <div>
            <span th:text="|${m.username} plays th ${m.instrumentEnum}|"></span>
            <form th:object="${removeMember}" th:action="@{/bands/myBands/remove/}" th:method="POST">
                <input type="hidden" name="bandId" th:value="${myBand.id}">
                <input type="hidden" name="username" th:value="${m.username}">
                <input type="hidden" name="instrument" th:value="${m.instrumentEnum}">
                <input type="submit" value="Remove member">
            </form>
        </div>
    </th:block>
    <th:block>
        <div th:unless="*{producer == null}">
            <span th:text="|Producer: *{producer}|"></span>
            <form th:object="${removeProducer}" th:action="@{/bands/myBands/remove/producer}" th:method="POST">
                <input type="hidden" name="bandId" th:value="${myBand.id}">
                <input type="hidden" name="producerUsername" th:value="${myBand.producer}">
                <input type="submit" value="Remove member">
            </form>
        </div>
    </th:block>
    <th:block th:each="r : ${myBand.requests}" th:object="${r}">
        <div>
            <a th:href="@{/users/details(id=${r.getUserId()})}">
                <span th:text="|Player username: *{username} |"></span>
                <th:block th:unless="*{isBecomeProducer()}">
                    <span th:text="|Applies for *{instrument} |"></span>
                </th:block>
                <th:block th:if="*{isBecomeProducer()}">
                    <span>Wants to become a producer</span>
                </th:block>
                <span th:text="*{isClosed()} ? 'The request is closed!' : 'The request is open!'"></span>
            </a>
            <th:block th:unless="*{isClosed()}">
                <form th:action="@{/bands/add/{request}(request=${r.id})}" th:method="POST">
                    <input type="radio" id="addMember" name="addMember" value="true">
                    <label for="addMember">Approve</label>
                    <input type="radio" id="rejectMembership" name="addMember" value="false">
                    <label for="rejectMembership">Reject</label>
                    <button type="submit">Confirm</button>
                </form>
            </th:block>
        </div>
    </th:block>
    <div>
        <a th:href="@{/bands/events/create(bandId=*{id})}">Create event</a>
    </div>
    <div>
        <form th:action="@{/bands/myBands/addPhoto/{id}(id=*{id})}" th:method="POST" enctype="multipart/form-data">
            <input type="file" id="file" name="file" class="custom-file-input" th:value="*{imgUrl}"/>
            <input type="submit" value="Upload picture">
        </form>
        <th:block th:if="${maxFileExceeded}">
            <p>Max file size exceeded! Max size is 128KB!</p>
        </th:block>
    </div>
    <!--<th:block th:unless="*{events.isEmpty()}">-->
    <a th:href="@{/bands/events(bandId=${myBand.id}, upcoming=true)}">Upcoming events</a>
    <a th:href="@{/bands/events(bandId=${myBand.id}, upcoming=false)}">Past events</a>
    <th:block th:unless="${upcomingEvents} == null">
        <th:block th:each="e : ${upcomingEvents}">
            <div>
                <span th:text="|${e.getEventType().name()} event |"></span>
                <span th:text="${e.getEventCategory()}"> </span>
                <span th:text="|Date: ${#temporals.format(e.getEventDate(), 'dd-MMM-yyyy HH:mm')}|"></span>
                <th:block th:if="${e.canceled == false}">
                    <a th:href="@{/bands/events/update(id=${e.id})}">Update event</a>
                </th:block>
                <th:block th:unless="${e.canceled}">
                    <form th:action="@{/bands/events/cancel/{id}(id=${e.id})}" th:method="DELETE">
                        <input type="submit" value="Cancel event">
                    </form>
                </th:block>
                <span th:if="${e.canceled}" th:text="CANCELED"></span>
                <div>
                    <span th:text="${e.description}"></span>
                </div>
            </div>
        </th:block>
    </th:block>
    <th:block th:unless="${pastEvents} == null">
        <th:block th:each="e : ${pastEvents}">
            <div>
                <span th:text="|${e.getEventType().name()} event |"></span>
                <span th:text="${e.getEventCategory()}"> </span>
                <span th:text="|Date: ${#temporals.format(e.getEventDate(), 'dd-MMM-yyyy HH:mm')}|"></span>
                <span th:if="${e.canceled}" th:text="CANCELED"></span>
                <div>
                    <span th:text="${e.description}"></span>
                </div>
            </div>
        </th:block>
    </th:block>
</div>

</body>
</html>